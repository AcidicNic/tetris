(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{14:function(e,t,n){},21:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var r=n(1),c=n.n(r),s=n(4),i=n.n(s),a=(n(14),n(5)),o=n(3),l=n(2),u="PAUSE",j="RESUME",d="MOVE_LEFT",b="MOVE_RIGHT",h="ROTATE",O="ROTATE_PREV",f="MOVE_DOWN",v="GAME_OVER",x="RESTART",g="HOLD_SHAPE",p=function(){return{type:b}},m=function(){return{type:d}},S=function(){return{type:h}},y=function(){return{type:f}},R=function(){return{type:u}},E=function(){return{type:j}},N=function(){return{type:x}},w=n(9),k=function(){for(var e=[],t=0;t<18;t++){e.push([]);for(var n=0;n<10;n++)e[t].push(0)}return e},A={left:["ArrowLeft","Left","a"],right:["ArrowRight","Right","d"],down:["ArrowDown","Down","s"],rotate:["ArrowUp","Up","w","x"],rotatePrev:["q","z"],holdShape:["c","e"],drop:[" "],pause:["Escape","Enter"],resume:["Escape","Enter"],restart:[" ","Enter"]},D=[[[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]],[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],[[[0,0,0,0],[1,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,1,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]]],[[[0,0,0,0],[1,1,1,0],[1,0,0,0],[0,0,0,0]],[[1,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,0,1,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]]],[[[1,0,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,1,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[0,0,1,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[1,1,0,0],[0,0,0,0]]],[[[0,0,0,0],[1,1,0,0],[0,1,1,0],[0,0,0,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]]],[[[0,0,0,0],[0,1,1,0],[1,1,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0],[0,0,0,0]]],[[[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]]]],H=function(){return e=1,t=D.length-1,Math.floor(Math.random()*(t-e+1))+e;var e,t},M=4,L=-4,P=500,C=function(){return{grid:k(),shape:H(),rotation:0,x:M,y:L,nextShape:H(),holdShape:0,canHoldShape:!0,isRunning:!0,score:0,speed:P,gameOver:!1,scoreSaved:!1,lines:0,level:0,highScore:F()}},_=function(e,t){return(t+1)%D[e].length},I=function(e,t){return 0===t?D[e].length-1:(t-1)%D[e].length},T=function(e,t,n,r,c){for(var s=D[e][c],i=t[0].length-1,a=t.length-1,o=0;o<s.length;o++)for(var l=0;l<s[o].length;l++)if(0!==s[o][l]){var u=l+n,j=o+r,d=t[j];if(u<0||u>i||j>a)return!1;if(void 0!==d&&0!==d[u])return!1}return!0},G=function(e,t,n,r,c){for(var s=!1,i=D[e][c],a=Object(w.a)(t),o=0;o<i.length;o++)for(var l=0;l<i[o].length;l++){if(i[o][l])o+r<0?s=!0:a[o+r][l+n]=e}return{grid:a,gameOver:s}},U=function(e){for(var t=0,n=0;n<e.length;n++)-1===e[n].indexOf(0)&&(t+=1,e.splice(n,1),e.unshift(Array(10).fill(0)));return{points:[0,40,100,300,1200][t],lines:t}},J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=e.shape,r=e.grid,c=e.x,s=e.y,i=e.rotation,a=e.nextShape,o=e.holdShape,u=e.score,j=e.isRunning,d=e.lines,b=e.level,h=e.speed,O=e.scoreSaved,f=(e.canHoldShape,s+t);if(T(n,r,c,f,i))return Object(l.a)(Object(l.a)({},e),{},{y:f});var v=G(n,r,c,s,i),x=v.grid,g=v.gameOver;if(g){var p=Object(l.a)({},e);return p.shape=0,p.grid=x,O?Object(l.a)(Object(l.a)({},e),{},{gameOver:!0}):(W(u),Object(l.a)(Object(l.a)({},e),{},{gameOver:!0,scoreSaved:!0}))}var m=C();m.grid=x,m.shape=a,m.holdShape=o,m.score=u,m.isRunning=j,m.lines=d,m.level=b,m.speed=h;var S=U(x);return m.score=u+S.points*(b+1),m.lines=d+S.lines,m.level=V(m.lines),m.speed=q(m.level),m},V=function(e){return Math.floor(e/3)},q=function(e){var t=P-100*e;return t>=100?t:50},F=function(){try{var e=localStorage.getItem("HIGH_SCORE");return null===e?0:JSON.parse(e)}catch(t){return 0}},W=function(e){try{var t=F();if(!t)return void localStorage.setItem("HIGH_SCORE",JSON.stringify(e));t<e&&localStorage.setItem("HIGH_SCORE",JSON.stringify(e))}catch(n){console.log(n)}},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C(),t=arguments.length>1?arguments[1]:void 0,n=e.shape,r=e.grid,c=e.x,s=e.y,i=e.rotation,a=e.nextShape,o=e.holdShape,p=(e.score,e.isRunning,e.lines,e.level,e.speed,e.scoreSaved,e.canHoldShape);switch(t.type){case h:var m=_(n,i);return T(n,r,c,s,m)?Object(l.a)(Object(l.a)({},e),{},{rotation:m}):e;case O:var S=I(n,i);return T(n,r,c,s,S)?Object(l.a)(Object(l.a)({},e),{},{rotation:S}):e;case b:return T(n,r,c+1,s,i)?Object(l.a)(Object(l.a)({},e),{},{x:c+1}):e;case d:return T(n,r,c-1,s,i)?Object(l.a)(Object(l.a)({},e),{},{x:c-1}):e;case f:return J(e);case j:return Object(l.a)(Object(l.a)({},e),{},{isRunning:!0});case u:return Object(l.a)(Object(l.a)({},e),{},{isRunning:!1});case v:return e;case x:return C();case g:if(!p)return e;var y=o,R=a;return 0===o&&(y=a,R=H()),Object(l.a)(Object(l.a)({},e),{},{shape:y,holdShape:n,nextShape:R,canHoldShape:!1,x:M,y:L});default:return e}},B=Object(a.a)({game:z}),K=(n(21),n(0));function Q(e){var t="grid-square color-".concat(e.color);return Object(K.jsx)("div",{className:t})}function X(e){var t=Object(r.useRef)(),n=Object(r.useRef)(0),c=Object(r.useRef)(0),s=Object(o.b)(),i=Object(o.c)((function(e){return e.game})),a=i.grid,l=i.shape,u=i.rotation,j=i.x,d=i.y,b=i.isRunning,h=i.speed,O=D[l][u],f=l,v=a.map((function(e,t){return e.map((function(e,n){var r=n-j,c=t-d,s=e;r>=0&&r<O.length&&c>=0&&c<O.length&&(s=0===O[c][r]?s:f);var i=t*a[0].length+n;return Object(K.jsx)(Q,{color:s},i)}))})),x=function e(r){if(t.current=requestAnimationFrame(e),b){n.current||(n.current=r);var i=r-n.current;c.current+=i,c.current>h&&(s(y()),c.current=0),n.current=r}};return Object(r.useEffect)((function(){return t.current=requestAnimationFrame(x),function(){return cancelAnimationFrame(t.current)}}),[b]),Object(K.jsx)("div",{className:"grid-board",children:v})}function Z(e){var t=Object(o.c)((function(e){return e.game.nextShape})),n=D[t][0].map((function(e,n){return e.map((function(e,r){return Object(K.jsx)(Q,{color:0===e?0:t},"".concat(n).concat(r))}))}));return Object(K.jsxs)("div",{children:[Object(K.jsx)("div",{className:"next-title",children:"Next:"}),Object(K.jsx)("div",{className:"next-block",children:n})]})}function Y(e){var t=Object(o.c)((function(e){return e.game.holdShape})),n=D[t][0].map((function(e,n){return e.map((function(e,r){return Object(K.jsx)(Q,{color:0===e?0:t},"".concat(n).concat(r))}))}));return Object(K.jsxs)("div",{children:[Object(K.jsx)("div",{className:"hold-title",children:"Hold:"}),Object(K.jsx)("div",{className:"hold-block",children:n})]})}function $(e){var t=Object(o.b)(),n=Object(o.c)((function(e){return e.game})),r=n.score,c=n.isRunning,s=n.gameOver,i=n.lines,a=n.level;return Object(K.jsxs)("div",{className:"score-board",children:[Object(K.jsxs)("div",{children:["Level: ",a]}),Object(K.jsxs)("div",{children:["Lines: ",i]}),Object(K.jsxs)("div",{children:["Score: ",r]}),Object(K.jsx)("button",{className:"score-board-button",onClick:function(e){s||t(c?R():E())},children:c?"Pause":"Play"}),Object(K.jsx)("button",{className:"score-board-button",onClick:function(e){t(N())},children:"Restart"})]})}function ee(e){Object(o.b)();var t=Object(o.c)((function(e){return e.game})),n=t.score,r=t.highScore;return Object(K.jsxs)("div",{className:"high-score",children:["High Score: ",Math.max(n,r)]})}function te(e){var t=Object(o.b)(),n=Object(o.c)((function(e){return e.game.isRunning})),c=Object(o.c)((function(e){return e.game.gameOver}));Object(r.useEffect)((function(){return document.addEventListener("keydown",s),function(){document.removeEventListener("keydown",s)}}));var s=function(e){if(!e.defaultPrevented)if(n)if(c)A.restart.includes(e.key)&&(t(N()),e.preventDefault());else{if(A.pause.includes(e.key))return t(R()),void e.preventDefault();A.down.includes(e.key)&&(t(y()),e.preventDefault()),A.left.includes(e.key)?(t(m()),e.preventDefault()):A.right.includes(e.key)&&(t(p()),e.preventDefault()),A.rotate.includes(e.key)?(t(S()),e.preventDefault()):A.rotatePrev.includes(e.key)&&(t({type:O}),e.preventDefault()),A.holdShape.includes(e.key)&&(t({type:g}),e.preventDefault())}else A.resume.includes(e.key)&&(t(E()),e.preventDefault())};return Object(K.jsxs)("div",{className:"controls-wrapper",children:[Object(K.jsxs)("div",{className:"controls",children:[Object(K.jsx)("button",{className:"control-button",disabled:!n||c,onClick:function(e){n&&!c&&t(m())},children:Object(K.jsx)("img",{className:"control-icon",src:"".concat("/tetris","/icons/arrow-left.svg"),alt:"Left"})}),Object(K.jsx)("button",{className:"control-button",disabled:!n||c,onClick:function(e){n&&!c&&t(p())},children:Object(K.jsx)("img",{className:"control-icon",src:"".concat("/tetris","/icons/arrow-right.svg"),alt:"Right"})}),Object(K.jsx)("button",{className:"control-button",disabled:!n||c,onClick:function(e){n&&!c&&t(S())},children:Object(K.jsx)("img",{className:"control-icon",src:"".concat("/tetris","/icons/arrow-rotate.svg"),alt:"Rotate"})}),Object(K.jsx)("button",{className:"control-button",disabled:!n||c,onClick:function(e){n&&!c&&t(y())},children:Object(K.jsx)("img",{className:"control-icon",src:"".concat("/tetris","/icons/arrow-down.svg"),alt:"Down"})})]}),Object(K.jsx)(ee,{})]})}function ne(e){var t=Object(o.c)((function(e){return e.game.isRunning})),n="",r="",c="hidden";return Object(o.c)((function(e){return e.game.gameOver}))?(n="Game Over",r="Press Space or Enter to restart!",c=""):t||(n="Paused",c=""),Object(K.jsxs)("div",{className:"message-popup ".concat(c),children:[Object(K.jsx)("h1",{children:n}),Object(K.jsx)("div",{children:r})]})}function re(){return Object(K.jsx)("div",{className:"info",children:Object(K.jsxs)("table",{className:"help-table table table-light",children:[Object(K.jsx)("thead",{children:Object(K.jsxs)("tr",{children:[Object(K.jsx)("th",{children:"Action"}),Object(K.jsx)("th",{children:"Key(s)"})]})}),Object(K.jsxs)("tbody",{children:[Object(K.jsxs)("tr",{children:[Object(K.jsx)("td",{children:"Move Left"}),Object(K.jsx)("td",{children:"Left Arrow, A"})]}),Object(K.jsxs)("tr",{children:[Object(K.jsx)("td",{children:"Move Right"}),Object(K.jsx)("td",{children:"Right Arrow, D"})]}),Object(K.jsxs)("tr",{children:[Object(K.jsx)("td",{children:"Move Down"}),Object(K.jsx)("td",{children:"Down Arrow, S"})]}),Object(K.jsxs)("tr",{children:[Object(K.jsx)("td",{children:"Hold Piece"}),Object(K.jsx)("td",{children:"C, E"})]}),Object(K.jsxs)("tr",{children:[Object(K.jsx)("td",{children:"Rotate Right"}),Object(K.jsx)("td",{children:"Up Arrow, W, X"})]}),Object(K.jsxs)("tr",{children:[Object(K.jsx)("td",{children:"Rotate Left"}),Object(K.jsx)("td",{children:"Q, Z"})]}),Object(K.jsxs)("tr",{children:[Object(K.jsx)("td",{children:"Pause / Unpause"}),Object(K.jsx)("td",{children:"Escape, Enter"})]}),Object(K.jsxs)("tr",{children:[Object(K.jsx)("td",{children:"Restart After Game Over"}),Object(K.jsx)("td",{children:"Space, Enter"})]})]})]})})}var ce=Object(a.b)(B);var se=function(){return Object(K.jsxs)(o.a,{store:ce,children:[Object(K.jsxs)("div",{className:"App",children:[Object(K.jsx)(X,{}),Object(K.jsxs)("div",{className:"block-info",children:[Object(K.jsx)(Z,{}),Object(K.jsx)(Y,{})]}),Object(K.jsx)($,{}),Object(K.jsx)(te,{}),Object(K.jsx)(ne,{})]}),Object(K.jsx)(re,{})]})};i.a.render(Object(K.jsx)(c.a.StrictMode,{children:Object(K.jsx)(se,{})}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.d20ef575.chunk.js.map