(this.webpackJsonptetris=this.webpackJsonptetris||[]).push([[0],{14:function(e,t,n){},21:function(e,t,n){},23:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(4),i=n.n(a),s=(n(14),n(5)),o=n(3),u=n(2),l="PAUSE",j="RESUME",d="MOVE_LEFT",b="MOVE_RIGHT",O="ROTATE",f="ROTATE_PREV",v="MOVE_DOWN",g="GAME_OVER",h="RESTART",m=function(){return{type:b}},p=function(){return{type:d}},x=function(){return{type:O}},y=function(){return{type:v}},R=function(){return{type:l}},E=function(){return{type:j}},N=function(){return{type:h}},S=n(9),w=function(){for(var e=[],t=0;t<18;t++){e.push([]);for(var n=0;n<10;n++)e[t].push(0)}return e},k={left:["ArrowLeft","Left","a"],right:["ArrowRight","Right","d"],down:["ArrowDown","Down","s"],rotate:["ArrowUp","Up","w","x"],rotatePrev:["q","z"],pause:["Escape","Enter"],resume:["Escape","Enter"],restart:[" ","Enter"]},A=[[[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]]],[[[0,0,0,0],[1,1,1,1],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]],[[[0,0,0,0],[1,1,1,0],[0,1,0,0],[0,0,0,0]],[[0,1,0,0],[1,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,1,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]]],[[[0,0,0,0],[1,1,1,0],[1,0,0,0],[0,0,0,0]],[[1,1,0,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,0,1,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[0,1,1,0],[0,0,0,0]]],[[[1,0,0,0],[1,1,1,0],[0,0,0,0],[0,0,0,0]],[[0,1,1,0],[0,1,0,0],[0,1,0,0],[0,0,0,0]],[[0,0,0,0],[1,1,1,0],[0,0,1,0],[0,0,0,0]],[[0,1,0,0],[0,1,0,0],[1,1,0,0],[0,0,0,0]]],[[[0,0,0,0],[1,1,0,0],[0,1,1,0],[0,0,0,0]],[[0,0,1,0],[0,1,1,0],[0,1,0,0],[0,0,0,0]]],[[[0,0,0,0],[0,1,1,0],[1,1,0,0],[0,0,0,0]],[[0,1,0,0],[0,1,1,0],[0,0,1,0],[0,0,0,0]]],[[[0,1,1,0],[0,1,1,0],[0,0,0,0],[0,0,0,0]]]],M=function(){return e=1,t=A.length-1,Math.floor(Math.random()*(t-e+1))+e;var e,t},C=function(){return{grid:w(),shape:M(),rotation:0,x:4,y:-4,nextShape:M(),isRunning:!0,score:0,speed:1e3,gameOver:!1,scoreSaved:!1,lines:0,level:0,highScore:D()}},T=function(e,t){return(t+1)%A[e].length},H=function(e,t){return 0===t?A[e].length-1:(t-1)%A[e].length},I=function(e,t,n,r,c){for(var a=A[e][c],i=t[0].length-1,s=t.length-1,o=0;o<a.length;o++)for(var u=0;u<a[o].length;u++)if(0!==a[o][u]){var l=u+n,j=o+r,d=t[j];if(l<0||l>i||j>s)return!1;if(void 0!==d&&0!==d[l])return!1}return!0},L=function(e,t,n,r,c){for(var a=!1,i=A[e][c],s=Object(S.a)(t),o=0;o<i.length;o++)for(var u=0;u<i[o].length;u++){if(i[o][u])o+r<0?a=!0:s[o+r][u+n]=e}return{grid:s,gameOver:a}},P=function(e){for(var t=0,n=0;n<e.length;n++)-1===e[n].indexOf(0)&&(t+=1,e.splice(n,1),e.unshift(Array(10).fill(0)));return{points:[0,40,100,300,1200][t],lines:t}},_=function(e){return Math.floor(e/4)},G=function(e){return e<=18?1e3-50*e:100},D=function(){try{var e=localStorage.getItem("HIGH_SCORE");return null===e?0:JSON.parse(e)}catch(t){return 0}},J=function(e){try{var t=D();if(!t)return void localStorage.setItem("HIGH_SCORE",JSON.stringify(e));t<e&&localStorage.setItem("HIGH_SCORE",JSON.stringify(e))}catch(n){console.log(n)}},V=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C(),t=arguments.length>1?arguments[1]:void 0,n=e.shape,r=e.grid,c=e.x,a=e.y,i=e.rotation,s=e.nextShape,o=e.score,m=e.isRunning,p=e.lines,x=e.level,y=e.speed,R=e.scoreSaved;switch(t.type){case O:var E=T(n,i);return I(n,r,c,a,E)?Object(u.a)(Object(u.a)({},e),{},{rotation:E}):e;case f:var N=H(n,i);return I(n,r,c,a,N)?Object(u.a)(Object(u.a)({},e),{},{rotation:N}):e;case b:return I(n,r,c+1,a,i)?Object(u.a)(Object(u.a)({},e),{},{x:c+1}):e;case d:return I(n,r,c-1,a,i)?Object(u.a)(Object(u.a)({},e),{},{x:c-1}):e;case v:var S=a+1;if(I(n,r,c,S,i))return Object(u.a)(Object(u.a)({},e),{},{y:S});var w=L(n,r,c,a,i),k=w.grid,A=w.gameOver;if(A){var M=Object(u.a)({},e);return M.shape=0,M.grid=k,R?Object(u.a)(Object(u.a)({},e),{},{gameOver:!0}):(J(o),Object(u.a)(Object(u.a)({},e),{},{gameOver:!0,scoreSaved:!0}))}var D=C();D.grid=k,D.shape=s,D.score=o,D.isRunning=m,D.lines=p,D.level=x,D.speed=y;var V=P(k);return D.score=o+V.points*(x+1),D.lines=p+V.lines,D.level=_(D.lines),D.speed=G(D.level),D;case j:return Object(u.a)(Object(u.a)({},e),{},{isRunning:!0});case l:return Object(u.a)(Object(u.a)({},e),{},{isRunning:!1});case g:return e;case h:return C();default:return e}},q=Object(s.a)({game:V}),F=(n(21),n(1));function U(e){var t="grid-square color-".concat(e.color);return Object(F.jsx)("div",{className:t})}function z(e){var t=Object(r.useRef)(),n=Object(r.useRef)(0),c=Object(r.useRef)(0),a=Object(o.b)(),i=Object(o.c)((function(e){return e.game})),s=i.grid,u=i.shape,l=i.rotation,j=i.x,d=i.y,b=i.isRunning,O=i.speed,f=A[u][l],v=u,g=s.map((function(e,t){return e.map((function(e,n){var r=n-j,c=t-d,a=e;r>=0&&r<f.length&&c>=0&&c<f.length&&(a=0===f[c][r]?a:v);var i=t*s[0].length+n;return Object(F.jsx)(U,{color:a},i)}))})),h=function e(r){if(t.current=requestAnimationFrame(e),b){n.current||(n.current=r);var i=r-n.current;c.current+=i,c.current>O&&(a(y()),c.current=0),n.current=r}};return Object(r.useEffect)((function(){return t.current=requestAnimationFrame(h),function(){return cancelAnimationFrame(t.current)}}),[b]),Object(F.jsx)("div",{className:"grid-board",children:g})}function B(e){var t=Object(o.c)((function(e){return e.game.nextShape})),n=A[t][0].map((function(e,n){return e.map((function(e,r){return Object(F.jsx)(U,{color:0===e?0:t},"".concat(n).concat(r))}))}));return Object(F.jsxs)("div",{children:[Object(F.jsx)("div",{className:"next-title",children:"Next:"}),Object(F.jsx)("div",{className:"next-block",children:n})]})}function W(e){var t=Object(o.b)(),n=Object(o.c)((function(e){return e.game})),r=n.score,c=n.isRunning,a=n.gameOver,i=n.lines,s=n.level,u=n.highScore;return Object(F.jsxs)("div",{className:"score-board",children:[Object(F.jsxs)("div",{children:["Level: ",s]}),Object(F.jsxs)("div",{children:["Lines: ",i]}),Object(F.jsxs)("div",{children:["Score: ",r]}),Object(F.jsx)("button",{className:"score-board-button",onClick:function(e){a||t(c?R():E())},children:c?"Pause":"Play"}),Object(F.jsx)("button",{className:"score-board-button",onClick:function(e){t(N())},children:"Restart"}),Object(F.jsxs)("div",{children:["High Score: ",Math.max(r,u)]})]})}function K(e){var t=Object(o.b)(),n=Object(o.c)((function(e){return e.game.isRunning})),c=Object(o.c)((function(e){return e.game.gameOver}));Object(r.useEffect)((function(){return document.addEventListener("keydown",a),function(){document.removeEventListener("keydown",a)}}));var a=function(e){e.defaultPrevented||(n?c?k.restart.includes(e.key)&&t(N()):k.pause.includes(e.key)?t(R()):(k.down.includes(e.key)&&t(y()),k.left.includes(e.key)?t(p()):k.right.includes(e.key)&&t(m()),k.rotate.includes(e.key)?t(x()):k.rotatePrev.includes(e.key)&&t({type:f}),e.preventDefault()):k.resume.includes(e.key)&&t(E()))};return Object(F.jsxs)("div",{className:"controls",children:[Object(F.jsx)("button",{className:"control-button",disabled:!n||c,onClick:function(e){n&&!c&&t(p())},children:Object(F.jsx)("img",{className:"control-icon",src:"".concat("/tetris","/icons/arrow-left.svg"),alt:"Left"})}),Object(F.jsx)("button",{className:"control-button",disabled:!n||c,onClick:function(e){n&&!c&&t(m())},children:Object(F.jsx)("img",{className:"control-icon",src:"".concat("/tetris","/icons/arrow-right.svg"),alt:"Right"})}),Object(F.jsx)("button",{className:"control-button",disabled:!n||c,onClick:function(e){n&&!c&&t(x())},children:Object(F.jsx)("img",{className:"control-icon",src:"".concat("/tetris","/icons/arrow-rotate.svg"),alt:"Rotate"})}),Object(F.jsx)("button",{className:"control-button",disabled:!n||c,onClick:function(e){n&&!c&&t(y())},children:Object(F.jsx)("img",{className:"control-icon",src:"".concat("/tetris","/icons/arrow-down.svg"),alt:"Down"})})]})}function Q(e){var t=Object(o.c)((function(e){return e.game.isRunning})),n="",r="hidden";return Object(o.c)((function(e){return e.game.gameOver}))?(n="Game Over",r=""):t||(n="Paused",r=""),Object(F.jsx)("div",{className:"message-popup ".concat(r),children:Object(F.jsx)("h1",{children:n})})}var X=Object(s.b)(q);var Y=function(){return Object(F.jsx)(o.a,{store:X,children:Object(F.jsxs)("div",{className:"App",children:[Object(F.jsx)("header",{className:"App-header",children:Object(F.jsx)("h1",{className:"App-title",children:"Tetris Redux"})}),Object(F.jsx)(z,{}),Object(F.jsx)(B,{}),Object(F.jsx)(W,{}),Object(F.jsx)(K,{}),Object(F.jsx)(Q,{})]})})};i.a.render(Object(F.jsx)(c.a.StrictMode,{children:Object(F.jsx)(Y,{})}),document.getElementById("root"))}},[[23,1,2]]]);
//# sourceMappingURL=main.b285368f.chunk.js.map